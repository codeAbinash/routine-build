import{u as y,r,j as e,T as c,l as s}from"./index.js";import{i as j}from"./images.js";function S(){const u=y(),[d,x]=r.useState("none"),[h,l]=r.useState("Apply Routine"),[m,a]=r.useState(!1);return e.jsxs("div",{className:"screen applyRoutine-screen justify-between start-screen p-5 flex select-none flex-col gap-5 min-h-[100dvh] dark:text-darkText",children:[e.jsxs("h1",{className:"text-dark dark:text-darkText text-[1.7rem] font-bold text-center mt-[3vh] p-5",children:["Select your college or school ",e.jsx("span",{children:"Routine"})," ",e.jsx("br",{}),e.jsx(c,{emoji:"🏫"})," ",e.jsx(c,{emoji:"📚"})," ",e.jsx(c,{emoji:"🎒"})]}),e.jsx("img",{src:j.undraw_city_girl_ccpd,className:"w-[90%] block mx-auto"}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("p",{className:"text-center text-base font-medium text-secondary pb-3",children:"Select Preferred Routine"}),e.jsxs("select",{onInput:n=>{x(n.target.value)},defaultValue:"none",id:"routines",name:"routines",className:"dark:bg-white/20 tap97 border-none outline-none p-3 py-5 appearance-none outline-accent rounded-xl input-bg font-medium text-center text-sm",children:[e.jsx("option",{value:"none",disabled:!0,children:"Select Your Routine"}),e.jsx("option",{value:"BUIE-CSE-2",children:"BUIE-CSE 2nd Semester 2023"})]}),e.jsxs("p",{className:"text-secondary text-xs text-center pt-1",children:["Cannot find your college in the list? To enter routine code manually ",e.jsx("span",{className:"text-accent font-semibold underline",children:"click here"})]})]}),e.jsxs("div",{className:"btnWrapper flex justify-between items-center w-full gap-3",children:[e.jsx("button",{onClick:()=>{s.set("startedUsing","yes"),u("/",{replace:!0})},className:"flex-[1.5] no-highlight select-none rounded-2xl bg-dark text-white  mx-auto block p-[1.3em] duration-150 active:scale-[0.98] text-sm",children:"Skip"}),e.jsx("button",{onClick:()=>f(d),className:"flex-[2.5] no-highlight select-none rounded-2xl bg-accent text-white  mx-auto block p-[1.3em] duration-150 active:scale-[0.98] text-sm",children:h})]})]});function f(n){if(n==="none")return alert("Please select a routine.");if(!window.confirm("Warning! Are you sure you want to apply this routine? Routine subscription ID is "+n+". If it is not your college or school routine, click 'cancel' and then click 'skip'.")||n==="")return;let o=null,i=null;if(m)return;l("Applying Routine..."),a(!0),console.log("Downloading Routine...");const g=fetch(`https://dataabinash.github.io/routine/${n}/info.json`).then(t=>t.json()).then(t=>{i=t}),b=fetch(`https://dataabinash.github.io/routine/${n}/routine.json`).then(t=>t.json()).then(t=>{o=t});Promise.all([g,b]).then(()=>{if(o&&i){console.log(o,i);const t=JSON.parse(s.get("subscriptions")||"{}");if(t[n]){alert("You are already subscribed to this routine.");return}else{t[n]=i,s.set("subscriptions",JSON.stringify(t));let p=JSON.parse(s.get("routines")||"[]");p.push(...o),s.set("routines",JSON.stringify(p)),console.log("Routine Applied Successfully."),s.set("startedUsing","yes"),l("Routine applied!"),a(!1),console.log("Navigate to /"),u("/",{replace:!0})}}else alert("Cannot find routine. Please check your internet connection and try again."),l("Apply Routine"),a(!1)})}}export{S as default};
