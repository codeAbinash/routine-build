import{R as y,r as o,j as e,g as E,d as D,E as k,u as O,a as T,l as R}from"./index.js";import{B as A}from"./BackHeader.js";function M({updateRoutine:u}){const[l,t]=y.useState(""),[i,a]=y.useState("");return o.useEffect(()=>{u({time:[l,i]})},[l,i]),e.jsx("div",{className:"dailyMakeRoutine",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"top flex items-center gap-3",children:[e.jsx("p",{className:"w-[50%] text-xs text-secondary pl-1 pb-1 mt-2",children:"Start Time"}),e.jsx("p",{className:"w-[50%] text-xs text-secondary pl-1 pb-1 mt-2",children:"End Time"})]}),e.jsxs("div",{className:"bottom items-center flex gap-3",children:[e.jsx("input",{type:"time",onInput:d=>t(d.target.value),className:"input-time-small input-text bg-inputBg dark:bg-darkInputBg tap rounded-xl"}),e.jsx("input",{type:"time",onInput:d=>a(d.target.value),className:"input-time-small input-text bg-inputBg dark:bg-darkInputBg tap rounded-xl"})]})]})})}function C({updateRoutine:u}){const l=new Date;l.setDate(l.getDate()+1);const[t,i]=o.useState(E(l)),[a,d]=o.useState(),m=o.useRef(),p=o.useRef();o.useEffect(()=>{u({time:[t,a]})},[t,a]);function c(s){a||d(s.target.value)}return e.jsx("div",{children:e.jsxs("div",{className:"inputTime mt-2 flex flex-col gap-2 w-full",children:[e.jsxs("div",{className:"bottom flex-1",children:[e.jsx("p",{className:"text-xs text-secondary pl-1 pb-1",children:"Start date and time"}),e.jsx("input",{ref:m,defaultValue:t,onInput:s=>{i(s.target.value),c(s)},type:"datetime-local",className:"input-text bg-inputBg dark:bg-darkInputBg appearance-none tap-99"})]}),e.jsxs("div",{className:"bottom flex-1",children:[e.jsx("p",{className:"text-xs text-secondary pl-1 pb-1",children:"End date and time"}),e.jsx("input",{ref:p,defaultValue:a,onInput:s=>d(s.target.value),type:"datetime-local",className:"input-text bg-inputBg dark:bg-darkInputBg appearance-none tap-99"})]})]})})}const q=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function $(u,l){let t=[null,null];for(let i=0;i<7;i++)u[i]&&(l[i][0]&&(t[0]=l[i][0]),l[i][1]&&(t[1]=l[i][1]));return t}function H({routine:u,updateRoutine:l}){const[t,i]=o.useState([!1,!0,!1,!0,!1,!0,!1]),[a,d]=o.useState([[null,null],[null,null],[null,null],[null,null],[null,null],[null,null],[null,null]]),m={};function p(){console.log(u);const[c,s]=$(t,a);console.log(c,s);for(let n=0;n<7;n++)t[n]?m[n]=a[n]:delete m[n],t[n]&&!a[n][0]&&!a[n][1]&&c&&s&&(m[n]=[c,s],a[n]=[c,s]);d([...a]),l({...u,time:m})}return e.jsxs("div",{className:"weeklyMakeRoutine mb-5",children:[e.jsxs("div",{className:"top flex items-center gap-1",children:[e.jsx("p",{className:"w-1/3 text-xs text-secondary pl-1 pb-1 mt-2 text-center",children:"Routine Dates"}),e.jsx("p",{className:"w-1/3 text-xs text-secondary pl-1 pb-1 mt-2 text-center",children:"Start Time"}),e.jsx("p",{className:"w-1/3 text-xs text-secondary pl-1 pb-1 mt-2 text-center",children:"End Time"})]}),e.jsx("div",{className:"flex flex-col gap-3 mt-2",children:q.map((c,s)=>e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsx("div",{className:`tap97 dayName check ${t[s]?"checkDiv active shadow-lg shadow-accent/50":"bg-inputBg dark:bg-darkInputBg"} px-4 py-3 rounded-xl flex-1 items-center justify-center`,onClick:()=>{D(()=>{t[s]=!t[s],p(),i([...t])})},children:e.jsx("p",{className:"text-center",children:c})}),e.jsxs("div",{className:`timeInput flex gap-3 flex-[3] ${t[s]?"":"opacity-40"} trans-opacity`,children:[e.jsx("input",{type:"time",className:"trans-opacity input-time-small bg-inputBg dark:bg-darkInputBg tap rounded-xl",disabled:!t[s],value:a[s][0]||"",onInput:n=>{a[s][0]=n.target.value,p()}}),e.jsx("input",{type:"time",value:a[s][1]||"",className:"trans-opacity input-time-small bg-inputBg dark:bg-darkInputBg tap rounded-xl",disabled:!t[s],onInput:n=>{a[s][1]=n.target.value,p()}})]})]},s))}),e.jsxs("p",{className:"text-xs text-center mt-5 text-secondary",children:["If it is an event, which is not in a range of time, specify only the ",e.jsx("span",{className:"test-medium",children:"Start Time"})," "]})]})}function J(){const u=new k;let l=["📕","🧑🏻‍💻","🏃🏻‍♂️","🎨","👻"];const[t,i]=o.useState(""),[a,d]=o.useState(""),[m,p]=o.useState(""),[c,s]=o.useState("weekly"),[n,N]=o.useState({}),v=O();function I(){v(-1)}return o.useEffect(()=>{console.log(n)}),e.jsxs("div",{className:"new-routine-screen screen dark:text-darkText select-none",children:[e.jsx(A,{title:"New Routine",backCb:()=>{confirm("Discard this routine?")&&I()}}),e.jsx("section",{className:"basic-details w-full p-4 pt-2",children:e.jsxs("div",{className:"min-h-[calc(100vh-100px)] flex flex-col justify-between items-center w-full",children:[e.jsxs("div",{className:"top flex flex-col gap-3 w-full",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-xs text-secondary pl-1 pb-1",children:"Routine name"}),e.jsxs("div",{className:"inputText flex flex-row gap-3",children:[e.jsx("img",{src:k.get(V(m)[0]),className:"tap h-[3.6rem] p-[0.8rem] bg-inputBg dark:bg-darkInputBg rounded-2xl"}),e.jsx("input",{value:t,onInput:r=>{i(r.target.value)},type:"text",placeholder:"Routine Name",className:"name input-text bg-inputBg dark:bg-darkInputBg"})]})]}),e.jsx("div",{className:"inputText",children:e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-xs text-secondary pl-1 pb-1",children:"Routine description"}),e.jsx("input",{value:a,onInput:r=>{d(r.target.value)},type:"text",placeholder:"Routine Description",className:"name input-text bg-inputBg dark:bg-darkInputBg"})]})}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-xs text-secondary pl-1 pb-1",children:"Routine emoji and repetition"}),e.jsxs("div",{className:"inputSelect flex justify-between items-center gap-3",children:[e.jsx("input",{type:"text",value:m,placeholder:"Custom Emoji",className:"name input-text bg-inputBg dark:bg-darkInputBg",onInput:r=>{p(r.target.value)}}),e.jsxs("select",{defaultValue:c,onInput:r=>s(r.target.value),className:"appearance-none p-[1rem] px-7 rounded-2xl trans-outline outline-none focus:outline-accent border-none bg-inputBg dark:bg-darkInputBg text-center",children:[e.jsx("option",{value:"once",children:"Repeat : Once"}),e.jsx("option",{value:"daily",children:"Repeat : Daily"}),e.jsx("option",{value:"weekly",children:"Repeat : Weekly"}),e.jsx("option",{value:"monthly",children:"Repeat : Monthly"}),e.jsx("option",{value:"yearly",children:"Repeat : Yearly"}),e.jsx("option",{value:"calendar",children:"Calendar Event"})]})]})]}),e.jsx("div",{className:"emojis flex gap-3 rounded-2xl flex-wrap justify-between items-center",children:l.map((r,j)=>e.jsx("img",{src:u.get(r),onClick:()=>p(r),className:"tap bg-inputBg dark:bg-darkInputBg h-[3.2rem] p-[0.8rem] rounded-2xl"},j))}),S(c)]}),e.jsx("div",{className:"btn w-full",children:e.jsx("button",{className:"btn-full no-highlight tap99 w-full text-sm",onClick:B,children:"Add this Routine"})})]})})]});function B(){if(i(t.trim()),d(a.trim()),!t)return alert("Routine name is required");if(c==="once"){if(!n.time[0])return alert("Routine time is required");let g=new Date(n.time[0]),h=new Date(n.time[1]);if(g>h)return alert("Start time should be less than end time");g.getTime()===h.getTime()&&(n.time[1]="")}if(c==="daily"){if(!n.time[0])return alert("Routine time is required");if(w(n.time[0],n.time[1]))return alert("Start time should be less than end time");n.time[1]=""}if(c==="weekly"){let g=n.time;if(!g||g&&Object.keys(g).length===0)return alert("At least one Routine time is required");const h={};let b=!1;for(let f=0;f<7;f++){const x=g[f];if(x){if(x[0]){if(h[f]=[],h[f][0]=x[0],b=!0,x[1]&&x[0]!==x[1]){if(w(x[0],x[1]))return alert(`There is wrong data in the time of ${T[f]}. The start time should be less than end time`);h[f][1]=x[1]}}else if(x[1])return alert(`There is wrong data in the time of ${T[f]}. The start time must be provided if end time is provided`)}}if(!b)return alert("At least one day should be selected");n.time=h}let r={name:t,description:a,emoji:m||"🧑🏻",type:c,...n};console.log(r);let j=JSON.parse(R.get("routines")||"[]");j.push(r),R.set("routines",JSON.stringify(j)),v(-1)}function S(r){return r==="once"?e.jsx(C,{updateRoutine:N}):r==="weekly"?e.jsx(H,{updateRoutine:N,routine:n}):r==="daily"?e.jsx(M,{updateRoutine:N}):e.jsx("div",{className:"mt-16 text-center",children:e.jsx("p",{children:"This screen is under development"})})}}function w(u,l){let t=u.split(":"),i=l.split(":"),a=parseInt(t[0]),d=parseInt(t[1]),m=parseInt(i[0]),p=parseInt(i[1]);return a>m||a===m&&d>p}function V(u){return u?[...new Intl.Segmenter().segment(u)].map(t=>t.segment):["🧑🏻"]}export{J as default};
